Version 4
SHEET 1 4228 2080
WIRE 48 -240 -400 -240
WIRE 48 -192 48 -240
WIRE 416 -176 272 -176
WIRE 560 -176 480 -176
WIRE 640 -176 560 -176
WIRE 736 -176 640 -176
WIRE 560 -144 560 -176
WIRE 640 -144 640 -176
WIRE 736 -112 736 -176
WIRE 272 -96 272 -176
WIRE 48 -80 48 -112
WIRE 560 -48 560 -64
WIRE 640 -48 640 -64
WIRE -400 16 -400 -240
WIRE 48 32 48 0
WIRE 272 48 272 -16
WIRE 560 48 560 16
WIRE 560 48 272 48
WIRE 640 48 640 16
WIRE 640 48 560 48
WIRE 736 48 736 -32
WIRE 736 48 640 48
WIRE -128 128 -176 128
WIRE 416 128 272 128
WIRE 560 128 480 128
WIRE 640 128 560 128
WIRE 736 128 640 128
WIRE 48 144 48 112
WIRE 560 144 560 128
WIRE 640 144 640 128
WIRE 48 176 48 144
WIRE 736 192 736 128
WIRE 272 208 272 128
WIRE 560 240 560 224
WIRE 640 240 640 224
WIRE -128 256 -128 128
WIRE -16 256 -48 256
WIRE 0 256 -16 256
WIRE -176 272 -176 256
WIRE 272 352 272 288
WIRE 560 352 560 304
WIRE 560 352 272 352
WIRE 640 352 640 304
WIRE 640 352 560 352
WIRE 736 352 736 272
WIRE 736 352 640 352
WIRE -400 368 -400 96
WIRE -176 368 -176 352
WIRE -176 368 -400 368
WIRE 48 368 48 272
WIRE 48 368 -176 368
WIRE -400 432 -400 368
WIRE 192 816 128 816
WIRE 336 816 272 816
WIRE 528 816 336 816
WIRE 864 848 864 816
WIRE 336 896 336 816
WIRE 864 960 864 928
WIRE 1024 960 864 960
WIRE 864 992 864 960
WIRE 336 1040 336 976
WIRE 864 1104 864 1072
WIRE 240 1200 240 1168
WIRE 0 1328 -64 1328
WIRE 240 1328 240 1280
WIRE 240 1328 80 1328
WIRE 304 1328 240 1328
WIRE 928 1328 720 1328
WIRE 304 1392 -48 1392
WIRE 1008 1392 720 1392
WIRE 1088 1392 1008 1392
WIRE 1296 1392 1088 1392
WIRE 1296 1408 1296 1392
WIRE 1088 1424 1088 1392
WIRE 800 1456 720 1456
WIRE 304 1520 240 1520
WIRE 1008 1520 1008 1392
WIRE 1008 1520 720 1520
WIRE 1296 1520 1296 1488
WIRE 1088 1536 1088 1488
WIRE 240 1584 16 1584
WIRE 304 1584 240 1584
WIRE 816 1584 720 1584
WIRE 304 1648 112 1648
WIRE 768 1648 720 1648
WIRE 16 1664 16 1584
WIRE 112 1696 112 1648
WIRE 240 1712 240 1584
WIRE 304 1712 240 1712
WIRE 816 1712 720 1712
WIRE 304 1776 240 1776
WIRE 896 1776 720 1776
WIRE 240 1808 240 1776
WIRE 16 1824 16 1728
WIRE 112 1824 112 1776
WIRE 240 1904 240 1872
FLAG -400 432 0
FLAG 736 -176 Vout2
FLAG 736 128 Vout3
FLAG 736 48 0
FLAG 736 352 0
FLAG 272 -176 Vsec+
FLAG 48 144 Vds
FLAG 48 -240 Vprim+
FLAG -16 256 Vg
FLAG 816 1584 0
FLAG 816 1712 0
FLAG 240 1904 0
FLAG 112 1824 0
FLAG 16 1824 0
FLAG 896 1776 PWM_in
FLAG 240 1520 Vosc
FLAG 336 1040 0
FLAG 528 816 Vo_comp
FLAG 864 1104 0
FLAG 1024 960 Vref_comp
FLAG 928 1328 Vref
FLAG 864 816 Vref
FLAG 800 1456 Vcontrol
FLAG -48 1392 Vref_comp
FLAG -64 1328 Vo_comp
FLAG 1088 1536 0
FLAG 1296 1520 0
FLAG -176 128 Vcontrol
FLAG 240 1168 PWM_in
FLAG 128 816 Vout3
DATAFLAG 128 1328 "round($*10000)/10000"
DATAFLAG 128 1392 "round($*10000)/10000"
DATAFLAG 432 816 "round(V(vo_comp)*10000)/10000"
DATAFLAG 832 1328 "round($*100)/100"
DATAFLAG 1088 1392 ""
DATAFLAG 944 960 "round($*10000)/10000"
DATAFLAG 816 1776 "round($*10000)/10000"
DATAFLAG 608 -176 "round($*100)/100"
DATAFLAG 608 128 "round($*100)/100"
SYMBOL nmos 0 176 R0
SYMATTR InstName M1
SYMATTR Value IRF530
SYMBOL diode 416 -160 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value MUR460
SYMBOL res -32 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rg
SYMATTR Value 56
SYMBOL cap 544 -48 R0
WINDOW 0 32 3 Left 2
SYMATTR InstName C2
SYMATTR Value 47µ
SYMBOL res 720 -128 R0
SYMATTR InstName RL2
SYMATTR Value 50
SYMBOL ind2 32 -96 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1
SYMATTR Value 19.989m
SYMATTR Type ind
SYMBOL ind2 288 -112 M0
SYMATTR InstName L2
SYMATTR Value 867.569µ
SYMATTR Type ind
SYMBOL diode 416 144 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value MUR460
SYMBOL cap 544 240 R0
WINDOW 0 32 3 Left 2
SYMATTR InstName C3
SYMATTR Value 47µ
SYMBOL ind2 288 192 M0
SYMATTR InstName L3
SYMATTR Value 401.164µ
SYMATTR Type ind
SYMBOL cap 624 240 R0
SYMATTR InstName C31
SYMATTR Value 1µ
SYMBOL cap 624 -48 R0
SYMATTR InstName C21
SYMATTR Value 1µ
SYMBOL cap 224 1808 R0
SYMATTR InstName Css
SYMATTR Value 5µ
SYMBOL cap 0 1664 R0
SYMATTR InstName CT
SYMATTR Value 3.3n
SYMBOL SG3525A 448 1424 R0
SYMATTR InstName U2
SYMATTR Value SG3525A
SYMBOL res 288 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rbo
SYMATTR Value 33k
SYMBOL res 352 992 R180
WINDOW 0 36 76 Left 2
WINDOW 3 34 44 Left 2
SYMATTR InstName Rao
SYMATTR Value 5.6k
SYMBOL res 880 944 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3bref
SYMATTR Value 12k
SYMBOL res 880 1088 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Raref
SYMATTR Value 10k
SYMBOL res 96 1680 R0
SYMATTR InstName RT
SYMATTR Value 2.7k
SYMBOL cap 1072 1424 R0
SYMATTR InstName Cd
SYMATTR Value 100n
SYMBOL voltage 1296 1392 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vgg
SYMATTR Value 16
SYMBOL res 96 1312 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 470
SYMBOL res 256 1296 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL voltage -176 256 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 16 0 0.1n 0.1n 4.35u 13.3u)
SYMBOL res 32 -96 R0
SYMATTR InstName R3
SYMATTR Value 1
SYMBOL ind 32 16 R0
SYMATTR InstName Ld
SYMATTR Value 1.9989m
SYMBOL res 544 128 R0
SYMATTR InstName R4
SYMATTR Value 1
SYMBOL res 624 128 R0
SYMATTR InstName R5
SYMATTR Value 1
SYMBOL res 544 -160 R0
SYMATTR InstName R6
SYMATTR Value 1
SYMBOL res 624 -160 R0
SYMATTR InstName R7
SYMATTR Value 1
SYMBOL res 720 176 R0
SYMATTR InstName R8
SYMATTR Value 800
SYMBOL voltage -400 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vd
SYMATTR Value 280
TEXT -192 488 Left 2 ;Vo/Vd = (N2/N1) * D/(1-D) = (L2/L1)^(1/2) * D/(1-D)
TEXT 88 -216 Left 2 !K1 L1 L2 L3 1
TEXT 104 -296 Left 2 ;Flyback
TEXT 1040 -296 Left 2 ;Directivas Spice
TEXT 1064 216 Left 2 !.inc opamp.sub
TEXT -408 1664 Left 2 ;fsw= 2/(CT*(RT*0.7))
TEXT -408 1720 Left 2 ;Con CT=3.3nF y RT = 2.8kOhm\n=> fsw = 75KHz
TEXT 912 1640 Left 2 !.inc SG3525A.sub
TEXT -408 1600 Left 2 ;Frecuencia
TEXT 64 728 Left 2 ;Divisor Vo
TEXT 800 728 Left 2 ;Divisor Vref
TEXT 1416 1360 Left 2 ;Ponemos una fuente constante solo para simular,porque el modelo spice no contempla la carga inicial de un capacitor entre los 300V y esta parte
TEXT 1088 -248 Left 2 !.param Fs = 75k
TEXT 1088 -216 Left 2 !.param Ts = 1/Fs
TEXT 1088 -184 Left 2 !.param Ton = Ts* D
TEXT 1088 -136 Left 2 !.param D=0.3
TEXT 1064 280 Left 2 !.tran 0 10m 0m 0.1m
TEXT 1288 1800 Left 2 ;Compensacion de Polos y Ceros
TEXT 1288 1832 Left 2 ;Ts aproximadamente  1/(C5*30) *10^-6
LINE Normal 1616 1760 1328 1760 2
LINE Normal 1664 1600 1664 1760 2
LINE Normal 1376 1600 1664 1600 2
LINE Normal 1328 1600 1376 1600 2
LINE Normal 1664 1760 1616 1760 2
LINE Normal 1296 1600 1328 1600 2
LINE Normal 1296 1760 1296 1600 2
LINE Normal 1328 1760 1296 1760 2
RECTANGLE Normal 880 576 -592 -336 2
RECTANGLE Normal 1584 -32 1008 -336 2
RECTANGLE Normal 208 1872 -448 1552 2
